$mydomain = "alchemistcloud.club"
$myhostname = "dev"
$gdapikey = "e4MxkPZ4mv8W_JKtMdBPeKsvadJVvepedwv:BHQneWg4khMGt5Y9m3itx4"

$myip = Invoke-RestMethod -Uri "https://api.ipify.org"
$dnsdata = Invoke-RestMethod "https://api.godaddy.com/v1/domains/$($mydomain)/records/A/$($myhostname)" -Headers @{ Authorization = "sso-key $($gdapikey)" }
$gdip = $dnsdata.data
Write-Output "$(Get-Date -Format 'u') - Current External IP is $($myip), GoDaddy DNS IP is $($gdip)"

If ( $gpid -ne $myip) {
  Write-Output "IP has changed!! Updating on GoDaddy"
  Invoke-RestMethod -Method PUT -Uri "https://api.godaddy.com/v1/domains/$($mydomain)/records/A/$($myhostname)" -Headers @{ Authorization = "sso-key $($gdapikey)" } -ContentType "application/json" -Body "[{`"data`": `"$($myip)`"}]";
}